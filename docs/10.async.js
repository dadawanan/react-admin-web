(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"+KLZ":function(e,t,a){e.exports={pageWrapper:"zxh-components-table-page-index-pageWrapper",formWrapper:"zxh-components-table-page-index-formWrapper"}},"/L/i":function(e,t,a){"use strict";var l=a("eVuz"),r=a("oWcC");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var s=r(a("wCAj"));a("14J3");var d=r(a("BMrR"));a("Pwec");var n=r(a("CtXQ"));a("+L6B");var i=r(a("2/Rp")),o=r(a("Wqku"));a("jCWc");var u=r(a("kPKH"));a("y8nQ");var c=r(a("Vl3Y")),m=l(a("q1tI")),f=a("WXbf"),p=a("LLXN"),h=a("IP2g"),g=r(a("+KLZ")),E=c.default.Item;class y extends m.PureComponent{constructor(){var e;e=super(...arguments),this.state={expand:!1,pagination:{page_index:1,page_size:10},sortedInfo:{},filteredInfo:{}},this.handleExpand=(()=>{this.setState({expand:!this.state.expand})}),this.getQueryItem=(()=>{var e=this.props,t=e.children,a=e.form.getFieldDecorator,l={base:[],more:[]};return l&&m.default.Children.map(t,(e,t)=>{var r=e.props,s=r.label,d=r.name,n=r.children;t<2?l.base.push(m.default.createElement(u.default,{key:t,span:6},m.default.createElement(E,{label:s},a(d)(n)))):l.more.push(m.default.createElement(u.default,{key:t,span:6},m.default.createElement(E,{label:s},n)))}),l}),this.handleSubmit=(e=>{e.preventDefault(),this.handleSearch(!0)}),this.handleSearch=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.props.form.getFieldsValue(),l=e.state,r=l.sortedInfo,s=l.filteredInfo,d=l.pagination,n=(0,o.default)({},d,a,s);r&&r.order&&(n.sorter=r.field+"|"+("ascend"===r.order?"asc":"desc")),t&&(n.page_index=1);var i=e.props,u=i.dispatch,c=i.url;u({type:c,payload:n||{}})},this.handleTableChange=((e,t,a)=>{this.setState({pagination:{page_index:e.current,page_size:e.pageSize},filteredInfo:t,sortedInfo:a},()=>{this.handleSearch(),this.props.onChange(a,t)})}),this.handleReset=(()=>{this.props.form.resetFields(),this.setState({sortedInfo:{},filteredInfo:{},pagination:{page_index:1,page_size:10}},()=>{this.handleSearch()}),this.props.onChange({},{})})}componentDidMount(){this.handleSearch()}render(){var e={xl:24,lg:16,md:8},t=this.props,a=t.data,l=t.columns,r=t.buttons,f=t.rowKey,y=t.loading,v=t.isTree,b=this.getQueryItem();return m.default.createElement("div",{className:g.default.pageWrapper},m.default.createElement(c.default,{className:g.default.formWrapper,onSubmit:this.handleSubmit},m.default.createElement(d.default,{gutter:(0,o.default)({},e)},b.base,b.base.length>0?m.default.createElement(u.default,{span:6},m.default.createElement(E,null,m.default.createElement(i.default,{type:"primary",htmlType:"submit"},m.default.createElement(h.FontAwesomeIcon,{icon:"search",style:{marginRight:"6px"}}),m.default.createElement(p.FormattedMessage,{id:"button.search"})),m.default.createElement(i.default,{onClick:this.handleReset,style:{marginLeft:8}},m.default.createElement(p.FormattedMessage,{id:"button.reset"})),b.more.length>0?m.default.createElement("a",{style:{marginLeft:8},onClick:this.handleExpand},this.state.expand?m.default.createElement("span",null,m.default.createElement(p.FormattedMessage,{id:"label.collapse"})," ",m.default.createElement(n.default,{type:"up"})):m.default.createElement("span",null,m.default.createElement(p.FormattedMessage,{id:"label.expand"})," ",m.default.createElement(n.default,{type:"down"}))):null)):null,m.default.createElement(u.default,{offset:18,style:{textAlign:"right"}},m.default.createElement(E,null,r))),this.state.expand?m.default.createElement(d.default,{gutter:(0,o.default)({},e)},b.more):null),m.default.createElement(s.default,{dataSource:v?a:a.rows,columns:l,rowKey:f,onChange:this.handleTableChange,loading:y,scroll:{x:"max-content"},pagination:!v&&{showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`${(0,p.formatMessage)({id:"pagination.total"})} ${e} ${(0,p.formatMessage)({id:"pagination.records"})}`,pageSizeOptions:["10","20","50","100"],total:a.count,current:a.page_index,pageSize:a.page_size}}))}}y.QueryItem=u.default,y.defaultProps={isTree:!1};var v=(0,f.connect)()(c.default.create()(y));t.default=v},Yfch:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.regTitle=t.regCode=t.regName=t.regPassword=t.regNameEn=t.regNameCn=t.regAccount=t.regPhone=void 0;var l=/^1[34578]\d{9}$/;t.regPhone=l;var r=/^[a-zA-Z0-9@._]{1,50}$/;t.regAccount=r;var s=/^[\u4e00-\u9fa5a-zA-Z. ]{1,50}$/;t.regNameCn=s;var d=/^[a-zA-Z. ]{1,50}$/;t.regNameEn=d;var n=/^[^\s]{4,50}$/;t.regPassword=n;var i=/^[\u4e00-\u9fa5a-zA-Z0-9. ]{1,50}$/;t.regName=i;var o=/^[a-zA-Z_0-9]{1,50}$/;t.regCode=o;var u=/^[\u4e00-\u9fa5\S]{1,50}$/;t.regTitle=u},iSpn:function(e,t,a){"use strict";var l=a("oWcC"),r=a("eVuz");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var s=l(a("2/Rp"));a("P2fV");var d=l(a("NJEC"));a("/zsF");var n=l(a("PArb"));a("+BJd");var i=l(a("mr32"));a("miYZ");var o=l(a("tsqr")),u=l(a("Wqku"));a("2qtc");var c=l(a("kLXV"));a("giR+");var m=l(a("fyUT"));a("OaEy");var f=l(a("2fM7"));a("5NDa");var p=l(a("5rEg")),h=l(a("CAYl"));a("nRaC");var g=l(a("5RzL")),E=l(a("18bz")),y=l(a("UpVr"));a("y8nQ");var v,b,M,_,x,I,C=l(a("Vl3Y")),w=r(a("q1tI")),F=l(a("/L/i")),V=a("IP2g"),S=a("LLXN"),k=a("WXbf"),L=a("+n12"),A=a("Yfch"),T=a("Zi5M"),R=(v=C.default.create(),v((M=class extends w.PureComponent{constructor(){var e;e=super(...arguments),this.state={parent_type:"",type:""},this.handleOk=(()=>{var e=this.props,t=e.form,a=e.handleSave;t.validateFieldsAndScroll((e,t)=>{e||(t.parent_id=t.parent_id?t.parent_id:0,t.sort_no=t.sort_no?t.sort_no:1,a(t))})}),this.handleExistResource=function(){var t=(0,y.default)(E.default.mark(function t(a,l,r){var s,d,n,i,o,u,c,m;return E.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=e.props,d=s.editInfo,n=s.form,i=n.getFieldValue("parent_id"),o={resource_name:l,parent_id:i||0},d&&(o.id=d.id),t.next=6,(0,T.existResource)(o);case 6:u=t.sent,c=u.code,m=u.data,!c&&m.exist&&r((0,S.formatMessage)({id:"validation.name.existed"})),r();case 11:case"end":return t.stop()}},t,this)}));return function(e,a,l){return t.apply(this,arguments)}}(),this.handleExistResourceCode=function(){var t=(0,y.default)(E.default.mark(function t(a,l,r){var s,d,n,i,o,u,c,m;return E.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=e.props,d=s.editInfo,n=s.form,i=n.getFieldValue("parent_id"),o={resource_code:l,parent_id:i||0},d&&(o.id=d.id),t.next=6,(0,T.existResourceCode)(o);case 6:u=t.sent,c=u.code,m=u.data,!c&&m.exist&&r((0,S.formatMessage)({id:"validation.code.existed"})),r();case 11:case"end":return t.stop()}},t,this)}));return function(e,a,l){return t.apply(this,arguments)}}(),this.handleChangeType=(e=>{this.setState({type:e})}),this.handleTreeChange=((e,t,a)=>{var l=a.triggerNode;this.setState({parent_type:l?l.props.resource_type:"",type:""}),this.props.form.setFieldsValue({resource_type:""})}),this.initTree=(e=>{this.setState({parent_type:e||""}),this.handleChangeType(this.props.form.getFieldValue("resource_type"))})}componentDidMount(){this.props.triggerRef(this)}render(){var e=this.props,t=e.form.getFieldDecorator,a=e.handleModalVisible,l=e.modalVisible,r=e.editInfo,s=e.dropList,d=e.mode,n=e.parent_id,i=this.state,o=i.type,u=i.parent_type,E={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:14}}};return w.default.createElement(c.default,{destroyOnClose:!0,title:w.default.createElement("span",null,d?w.default.createElement("span",null,w.default.createElement(V.FontAwesomeIcon,{icon:"plus"})," ",w.default.createElement(S.FormattedMessage,{id:"system.resource.modal.add"})):w.default.createElement("span",null,w.default.createElement(V.FontAwesomeIcon,{icon:"edit"})," ",w.default.createElement(S.FormattedMessage,{id:"system.resource.modal.edit"}))),visible:l,onOk:this.handleOk,onCancel:()=>a()},w.default.createElement(C.default,null,w.default.createElement(C.default.Item,(0,h.default)({},E,{label:(0,S.formatMessage)({id:"label.upper"})}),t("parent_id",{initialValue:d?n:r.parent_id,validateFirst:!0,rules:[]})(w.default.createElement(g.default,{disabled:!d,treeDefaultExpandAll:!0,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:s,onChange:this.handleTreeChange}))),w.default.createElement(C.default.Item,(0,h.default)({},E,{label:(0,S.formatMessage)({id:"label.name"})}),t("resource_name",{initialValue:d?"":r.resource_name,validateFirst:!0,rules:[{required:!0,whitespace:!1,message:(0,S.formatMessage)({id:"validation.name.required"})},{pattern:A.regTitle,message:(0,S.formatMessage)({id:"validation.name"})},{validator:this.handleExistResource}]})(w.default.createElement(p.default,null))),w.default.createElement(C.default.Item,(0,h.default)({},E,{label:(0,S.formatMessage)({id:"label.type"})}),t("resource_type",{initialValue:d?"":r.resource_type,rules:[{required:!0,message:(0,S.formatMessage)({id:"validation.type.required"})}]})(w.default.createElement(f.default,{disabled:!d,onChange:this.handleChangeType},1==u||""==u?w.default.createElement(f.default.Option,{value:1},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.module"})):null,1==u||""==u?w.default.createElement(f.default.Option,{value:2},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.menu"})):null,2==u?w.default.createElement(f.default.Option,{value:3},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.permission"})):null,3==u?w.default.createElement(f.default.Option,{value:4},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.api"})):null))),1==o||2==o||3==o?w.default.createElement(C.default.Item,(0,h.default)({},E,{label:(0,S.formatMessage)({id:"label.code"})}),t("resource_code",{initialValue:d?"":r.resource_code,rules:[{required:!0,whitespace:!1,message:(0,S.formatMessage)({id:"validation.code.required"})},{max:50,min:1,pattern:A.regCode,message:(0,S.formatMessage)({id:"validation.code"})},{validator:this.handleExistResourceCode}]})(w.default.createElement(p.default,null))):null,2==o||4==o?w.default.createElement(C.default.Item,(0,h.default)({},E,{label:(0,S.formatMessage)({id:"label.path"})}),t("path",{initialValue:d?"":r.path,rules:[{required:!0,message:(0,S.formatMessage)({id:"validation.path.required"})}]})(w.default.createElement(p.default,null))):null,1==o||2==o?w.default.createElement(C.default.Item,(0,h.default)({},E,{label:(0,S.formatMessage)({id:"label.icon"})}),t("icon",{initialValue:d?"":r.icon,rules:[]})(w.default.createElement(p.default,null))):null,1==o||2==o||3==o?w.default.createElement(C.default.Item,(0,h.default)({},E,{label:(0,S.formatMessage)({id:"label.sort"})}),t("sort_no",{initialValue:d?"":r.sort_no})(w.default.createElement(m.default,{min:0,step:1,style:{width:"100%"}}))):null))}},b=M))||b),z=(_=(0,k.connect)(e=>{var t=e.resource,a=e.loading;return{data:t.data,dropList:t.dropList,loading:a.effects["resource/getList"]}}),_((I=class extends w.PureComponent{constructor(){super(...arguments),this.state={sortedInfo:{},filteredInfo:{},modalVisible:!1,modalVisible:!1,modalMode:!0,editInfo:{},parent_id:""},this.initDropList=(()=>{var e=this.props.dispatch;e({type:"resource/getDropList"})}),this.handleChange=((e,t)=>{this.setState({sortedInfo:(0,u.default)({},e),filteredInfo:(0,u.default)({},t)})}),this.handleDelete=(e=>{var t=this.props.dispatch;t({type:"resource/delete",payload:{id:e},callback:()=>{o.default.success((0,S.formatMessage)({id:"msg.deleted"}))}})}),this.handleModalVisible=(e=>{this.setState({modalVisible:!this.state.modalVisible})}),this.handleCreate=((e,t)=>{this.setState({parent_id:e||"",modalMode:!0,modalVisible:!this.state.modalVisible},()=>{this.child.initTree(t)})}),this.handleEdit=(e=>{this.setState({modalMode:!1,editInfo:e,modalVisible:!this.state.modalVisible},()=>{var t=e.resource_type;this.child.initTree(3==t?2:1)})}),this.handleSave=(e=>{var t=this.props.dispatch,a=this.state,l=a.modalMode,r=a.editInfo;t({type:l?"resource/create":"resource/update",payload:l?e:Object.assign(e,{id:r.id}),callback:()=>{this.setState({modalVisible:!1,modalVisible:!1}),o.default.success(l?(0,S.formatMessage)({id:"msg.created"}):(0,S.formatMessage)({id:"msg.updated"})),this.initDropList()}})}),this.bindRef=(e=>{this.child=e})}componentDidMount(){this.initDropList()}render(){var e=this.props,t=e.data,a=e.loading,l=e.dropList,r=(this.state.sortedInfo,[{title:(0,S.formatMessage)({id:"label.name"}),key:"resource_name",dataIndex:"resource_name",fixed:!0,width:300},{title:(0,S.formatMessage)({id:"label.type"}),key:"resource_type",dataIndex:"resource_type",width:140,render:e=>w.default.createElement("span",null,1==e?w.default.createElement(i.default,{color:"orange"},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.module"})):2==e?w.default.createElement(i.default,{color:"green"},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.menu"})):3==e?w.default.createElement(i.default,{color:"blue"},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.permission"})):w.default.createElement(i.default,{color:"grey"},w.default.createElement(S.FormattedMessage,{id:"system.resource.type.api"})))},{title:(0,S.formatMessage)({id:"label.code"}),key:"resource_code",dataIndex:"resource_code",width:180},{title:(0,S.formatMessage)({id:"label.path"}),key:"path",dataIndex:"path",width:280},{title:(0,S.formatMessage)({id:"label.icon"}),key:"icon",dataIndex:"icon",width:160,render:e=>w.default.createElement("span",null,e?w.default.createElement(V.FontAwesomeIcon,{icon:e}):null)},{title:(0,S.formatMessage)({id:"label.create-time"}),key:"create_time",dataIndex:"create_time",render:e=>w.default.createElement("span",null,(0,L.formatTime)(e))},{title:(0,S.formatMessage)({id:"label.operation"}),key:"operation",fixed:"right",width:200,render:(e,t)=>w.default.createElement("div",null,w.default.createElement("span",null,4!=t.resource_type?w.default.createElement("span",null,w.default.createElement("a",{href:"javascript:;",onClick:()=>this.handleCreate(t.id,t.resource_type)},w.default.createElement(V.FontAwesomeIcon,{icon:"plus"})," ",w.default.createElement(S.FormattedMessage,{id:"system.resource.button.add"})),w.default.createElement(n.default,{type:"vertical"})):null,w.default.createElement("a",{href:"javascript:;",onClick:()=>this.handleEdit(t)},w.default.createElement(V.FontAwesomeIcon,{icon:"edit"})," ",w.default.createElement(S.FormattedMessage,{id:"label.edit"})),w.default.createElement(n.default,{type:"vertical"}),w.default.createElement(d.default,{placement:"topRight",icon:w.default.createElement(V.FontAwesomeIcon,{icon:"question-circle",className:"danger"}),okText:(0,S.formatMessage)({id:"button.yes"}),cancelText:(0,S.formatMessage)({id:"button.no"}),title:(0,S.formatMessage)({id:"system.resource.delete.prompt"}),onConfirm:()=>this.handleDelete(t.id)},w.default.createElement("a",{href:"javascript:;"},w.default.createElement(V.FontAwesomeIcon,{icon:"times"})," ",w.default.createElement(S.FormattedMessage,{id:"label.delete"})))))}]),o=w.default.createElement(w.default.Fragment,null,w.default.createElement(s.default,{type:"primary",onClick:()=>this.handleCreate("","")},w.default.createElement(V.FontAwesomeIcon,{icon:"plus",style:{marginRight:"6px"}}),w.default.createElement(S.FormattedMessage,{id:"button.add"}))),u={mode:this.state.modalMode,parent_id:this.state.parent_id,editInfo:this.state.editInfo,modalVisible:this.state.modalVisible,handleModalVisible:this.handleModalVisible,handleSave:this.handleSave,dropList:l,triggerRef:this.bindRef};return w.default.createElement(w.Fragment,null,w.default.createElement(F.default,{loading:a,url:"resource/getList",isTree:!0,data:t,columns:r,buttons:o,rowKey:"id",onChange:this.handleChange}),w.default.createElement(R,u))}},x=I))||x),P=z;t.default=P}}]);